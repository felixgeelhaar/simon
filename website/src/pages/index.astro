---
import Layout from '../layouts/Layout.astro';

const base = import.meta.env.BASE_URL;
const castPath = base.endsWith('/') ? `${base}simon_demo.cast` : `${base}/simon_demo.cast`;

const capabilities = [
	{
		title: 'Coach',
		description: 'Defines a goal, definition of done, and evidence list before the agent starts making API calls.'
	},
	{
		title: 'Guard',
		description: 'Applies hard budgets, command scoping, and verification gates so every tool call stays within policy.'
	},
	{
		title: 'Runtime',
		description: 'Episodes advance with rolling summaries so the session never collapses even during long interactions.'
	},
	{
		title: 'MCP Proxy',
		description: 'Digest tool outputs internally to reduce noise and protect secrets before the agent sees them.'
	},
	{
		title: 'Memory',
		description: 'Vectorized experience recall archives completed sessions for future reference.'
	},
	{
		title: 'CLI first',
		description: 'Local-first Go binary with a Bubble Tea TUI keeps you in control on every host.'
	}
];

const workflow = [
	{
		step: 'Plan the mission',
		plan: 'Write the goal, definition of done, and evidence list in the YAML task file.'
	},
	{
		step: 'Run under guard',
		plan: 'The CLI enforces budgets, intercepts tool calls, and streams status updates at each iteration.'
	},
	{
		step: 'Verify completion',
		plan: 'Every piece of evidence is checked before the task is marked done and memory is archived.'
	},
	{
		step: 'Record the impact',
		plan: 'Asciinema captures the terminal with chapters so the run can be replayed and reviewed with full context.'
	}
];

const journey = [
	{
		phase: 'Plan',
		description: 'Define the goal, definition of done, and evidence list in the YAML task so the session starts with clarity.'
	},
	{
		phase: 'Execute',
		description: 'Simon runs the iterations under guard, enforcing budgets and summarizing progress every episode.'
	},
	{
		phase: 'Verify',
		description: 'Evidence is collected, checked, and only then does the runtime mark the task complete.'
	},
	{
		phase: 'Archive',
		description: 'Session memory is vectorized so future runs learn from the exact same journey.'
	},
	{
		phase: 'Share',
		description: 'The cast recording pairs with the evidence summary so stakeholders replay the full journey, not just logs.'
	}
];

const docHighlights = [
	{
		title: 'Governance & Security',
		text: 'Simon treats LLMs as workers and applies deterministic rules: budgets halt execution, commands are scoped, and evidence gates prevent hallucinated deliveries.'
	},
	{
		title: 'Architecture',
		text: 'Built in Go with Cobra + Bubble Tea, storage on SQLite + the local filesystem, and a plugin-ready guard/coach layer.'
	},
	{
		title: 'Deployment',
		text: 'The README outlines GitHub Pages for marketing and optionally a Homebrew tap for distribution.'
	},
	{
		title: 'Recordings',
		text: 'Every run is captured end-to-end, from the first plan to the final evidence check, so reviewers can replay the exact execution trail.'
	}
];

const recordingPillars = [
	{
		title: 'Full-fidelity capture',
		text: 'The CLI session is recorded as it runs, preserving every command, guard decision, and runtime status update.'
	},
	{
		title: 'Episode-aware playback',
		text: 'Recordings are anchored to the same episode cadence as the runtime, so reviewers can jump to meaningful checkpoints fast.'
	},
	{
		title: 'Shareable by default',
		text: 'Asciinema cast files play anywhere and keep stakeholders aligned without shipping raw logs or screen recordings.'
	}
];

const recordingChapters = [
	{
		label: 'Mission brief',
		time: 0,
		detail: 'Goal, definition of done, and evidence list confirmed.'
	},
	{
		label: 'Guarded execution',
		time: 28,
		detail: 'Budgets enforced while the agent iterates safely.'
	},
	{
		label: 'Evidence check',
		time: 74,
		detail: 'Outputs verified before the run is marked complete.'
	},
	{
		label: 'Archive + share',
		time: 110,
		detail: 'Session archived and ready for replay.'
	}
];

const recordingStats = [
	{
		label: 'Target episode length',
		value: '2-4 min',
		note: 'Short enough to review, long enough to show real work.'
	},
	{
		label: 'Playback density',
		value: '1.1x',
		note: 'Optimized for clarity over speed.'
	},
	{
		label: 'Stakeholder handoff',
		value: 'Cast + notes',
		note: 'Share the recording alongside the outcome.'
	}
];
---

<Layout title="Simon — AI Agent Governance Runtime">
	<link
		rel="stylesheet"
		type="text/css"
		href="https://cdn.jsdelivr.net/npm/asciinema-player@3.14.0/dist/bundle/asciinema-player.css"
		slot="head"
	/>
	<script
		src="https://cdn.jsdelivr.net/npm/asciinema-player@3.14.0/dist/bundle/asciinema-player.min.js"
		is:inline
		defer
		slot="head"
	></script>

	<main id="main-content" class="w-full overflow-hidden" role="main">
		<section class="relative isolate overflow-hidden border-b border-white/10 bg-gradient-to-b from-black via-slate-950 to-black py-16">
			<div class="pointer-events-none absolute inset-x-0 top-0 h-36 bg-gradient-to-b from-slate-900/90 to-transparent"></div>
			<div class="relative z-10 mx-auto flex max-w-6xl flex-col gap-8 px-6">
				<p class="text-xs uppercase tracking-[0.5em] text-slate-400">Deterministic control plane</p>
				<h1 class="text-4xl font-semibold leading-tight text-white md:text-5xl">
					Simon governs every episode, so AI agents stay factual, budgeted, and verifiable.
				</h1>
				<p class="text-lg text-slate-300 md:max-w-3xl">
					Local-first infrastructure that enforces goals, safe command usage, and evidence collection. Slack, fuzziness, and hallucinations
					are handled by the runtime, not by hopeful prompting.
				</p>

				<div class="flex flex-wrap gap-4">
					<a
						class="btn-primary flex items-center justify-center rounded-full px-6 py-3 text-base font-semibold transition"
						href="https://github.com/felixgeelhaar/simon"
						target="_blank"
						rel="noreferrer"
						aria-label="View the code on GitHub (opens in new tab)"
					>
						View the code
					</a>
					<a
						class="btn-secondary flex items-center justify-center rounded-full px-6 py-3 text-base font-semibold transition"
						href="https://github.com/felixgeelhaar/simon#readme"
						aria-label="Read the README documentation"
					>
						Read the README
					</a>
					<span class="pill bg-white/10 text-white" aria-label="Built with CLI, Bubble Tea, and local-first architecture">CLI · Bubble Tea · Local</span>
				</div>

				<div class="glass-panel mt-6 rounded-3xl p-6">
					<p class="text-xs uppercase tracking-[0.4em] text-slate-400">Journey spotlight</p>
					<h2 class="mt-2 text-lg font-semibold text-white">The full experience, not just logs</h2>
					<p class="text-sm text-slate-400">
						Plan, guard, verify, archive, and share—the recording mirrors the entire journey so the site communicates how Simon governs AI sessions.
					</p>
				</div>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto grid max-w-6xl gap-6 px-6 md:grid-cols-2 lg:grid-cols-4">
				{docHighlights.map((note) => (
					<article key={note.title} class="glass-panel rounded-3xl p-6">
						<p class="text-xs font-semibold uppercase tracking-[0.4em] text-slate-400">{note.title}</p>
						<p class="mt-4 text-sm text-slate-200">{note.text}</p>
					</article>
				))}
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto flex max-w-6xl flex-col gap-10 px-6">
				<h2 class="text-3xl font-semibold text-white">Governance stack</h2>
				<p class="text-slate-300">
					The README highlights Coach, Guard, and Runtime as the fundamental pillars, with MCP proxy and Memory providing context and safety.
				</p>
				<div class="grid gap-6 md:grid-cols-2">
					{capabilities.map((capability) => (
						<div key={capability.title} class="glass-panel rounded-3xl p-6">
							<p class="text-sm font-semibold uppercase tracking-[0.4em] text-slate-400">{capability.title}</p>
							<p class="mt-3 text-slate-200">{capability.description}</p>
						</div>
					))}
				</div>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto flex max-w-6xl flex-col gap-10 px-6">
				<h2 class="text-3xl font-semibold text-white">Session lifecycle</h2>
				<p class="text-slate-300">
					Every run progresses through planning, iteration, verification, and archiving. There are no loose ends once the definition
					of done is satisfied and the evidence list is confirmed.
				</p>
				<div class="grid gap-6 md:grid-cols-2">
					{workflow.map((item) => (
						<article key={item.step} class="glass-panel rounded-3xl p-6 text-slate-100">
							<p class="text-xs font-semibold uppercase tracking-[0.4em] text-slate-400">{item.step}</p>
							<p class="mt-3 text-slate-200">{item.plan}</p>
						</article>
					))}
				</div>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto flex max-w-6xl flex-col gap-10 px-6">
				<div class="flex flex-col gap-4">
					<p class="text-xs uppercase tracking-[0.4em] text-slate-400">Best-in-class recordings</p>
					<h2 class="text-3xl font-semibold text-white">Recordings that prove the work</h2>
					<p class="text-slate-300">
						Simon doesn't just log output; it captures the journey in a replayable narrative. Reviewers can understand intent, guardrails,
						and evidence without hunting through terminal history.
					</p>
				</div>
				<div class="grid gap-6 lg:grid-cols-[1.2fr_0.8fr]">
					<div class="grid gap-6 md:grid-cols-3 lg:grid-cols-1">
						{recordingPillars.map((pillar) => (
							<article key={pillar.title} class="glass-panel rounded-3xl p-6">
								<p class="text-sm font-semibold uppercase tracking-[0.4em] text-slate-400">{pillar.title}</p>
								<p class="mt-3 text-slate-200">{pillar.text}</p>
							</article>
						))}
					</div>
					<div class="glass-panel rounded-3xl p-6">
						<h3 class="text-lg font-semibold text-white">Recording performance</h3>
						<p class="mt-2 text-sm text-slate-400">
							Designed to keep reviewers in flow while preserving the full execution trail.
						</p>
						<div class="mt-6 grid gap-4">
							{recordingStats.map((stat) => (
								<div key={stat.label} class="rounded-2xl border border-white/10 bg-white/5 p-4">
									<p class="text-xs uppercase tracking-[0.35em] text-slate-400">{stat.label}</p>
									<p class="mt-2 text-xl font-semibold text-white">{stat.value}</p>
									<p class="mt-1 text-sm text-slate-300">{stat.note}</p>
								</div>
							))}
						</div>
					</div>
				</div>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto flex max-w-6xl flex-col gap-8 px-6">
				<h2 class="text-3xl font-semibold text-white">Journey timeline</h2>
				<p class="text-slate-300">
					Each stage of the session is visible on the marketing site so visitors understand how Simon shepherds work from start to finish.
				</p>
				<div class="grid gap-6 md:grid-cols-3">
					{journey.map((entry) => (
						<article key={entry.phase} class="glass-panel rounded-3xl p-6">
							<p class="text-sm font-semibold uppercase tracking-[0.4em] text-slate-400">{entry.phase}</p>
							<p class="mt-3 text-slate-200">{entry.description}</p>
						</article>
					))}
				</div>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto flex max-w-6xl flex-col gap-6 px-6">
				<h2 class="text-3xl font-semibold text-white">How to get started</h2>
				<p class="text-slate-300">
					Simon is built locally. Clone the repo, build the binary, configure your preferred provider, then run a task with the CLI.
				</p>
				<pre class="glass-panel rounded-3xl p-6 text-sm text-slate-100">
git clone https://github.com/felixgeelhaar/simon.git
cd simon
go build -o simon cmd/simon/main.go

./simon config set openai.api_key your-api-key
./simon run task.yaml --provider openai
				</pre>
				<p class="text-sm text-slate-400">Quick start instructions are pulled directly from the README.</p>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto grid max-w-6xl gap-6 px-6 lg:grid-cols-[0.95fr_1.05fr]">
				<div class="flex flex-col gap-6">
					<div>
						<h2 class="text-3xl font-semibold text-white">Session playback</h2>
						<p class="text-slate-300">
							The hero recording uses the stub provider so it can run without upstream latency or costs, while still showing the full guard
							and verification workflow.
						</p>
					</div>
					<div class="grid gap-4" role="group" aria-label="Recording chapters">
						{recordingChapters.map((chapter) => (
							<button
								key={chapter.label}
								type="button"
								class="recording-chapter chapter-button flex flex-col gap-1 rounded-2xl border border-white/10 bg-white/5 p-4 text-left"
								data-time={chapter.time}
								aria-label={`Jump to ${chapter.label}: ${chapter.detail}`}
							>
								<span class="text-xs uppercase tracking-[0.35em] text-slate-400">{chapter.label}</span>
								<span class="text-sm text-slate-200">{chapter.detail}</span>
							</button>
						))}
					</div>
				</div>
				<div class="glass-panel rounded-3xl p-6">
					<div class="cast-player overflow-hidden rounded-2xl border border-white/10 bg-black/60">
						<div id="player" data-cast={castPath}></div>
					</div>
					<div class="mt-4 grid gap-3 text-sm text-slate-300">
						<p class="text-xs uppercase tracking-[0.35em] text-slate-400">Recording checklist</p>
						<ul class="grid gap-2">
							<li class="rounded-xl border border-white/10 bg-white/5 px-4 py-3">Goal + definition of done snapshot</li>
							<li class="rounded-xl border border-white/10 bg-white/5 px-4 py-3">Guard decisions and budget checkpoints</li>
							<li class="rounded-xl border border-white/10 bg-white/5 px-4 py-3">Evidence validation captured in-line</li>
						</ul>
					</div>
				</div>
			</div>
		</section>

		<section class="border-b border-white/10 py-16">
			<div class="mx-auto flex max-w-6xl flex-col gap-6 px-6 text-center">
				<p class="text-xs uppercase tracking-[0.6em] text-slate-400">Built for power developers</p>
				<h2 class="text-3xl font-semibold text-white">Control the execution, not just the prompt</h2>
				<p class="text-slate-300">
					Simon is local-first, configurable, and deterministic. The documentation and recording show exactly what the CLI outputs—
					no vague marketing fluff.
				</p>
				<div class="flex flex-wrap justify-center gap-4">
					<a
						class="btn-primary rounded-full px-8 py-3 font-semibold transition"
						href="https://github.com/felixgeelhaar/simon"
						target="_blank"
						rel="noreferrer"
						aria-label="Clone the repository on GitHub (opens in new tab)"
					>
						Clone the repository
					</a>
					<a
						class="btn-secondary rounded-full px-8 py-3 font-semibold transition"
						href="https://github.com/felixgeelhaar/simon#quick-start"
						aria-label="Follow the quick start guide"
					>
						Follow the quick start
					</a>
				</div>
			</div>
		</section>
	</main>

	<script is:inline>
		let playerInstance = null;

		function hookChapterControls() {
			const buttons = document.querySelectorAll('.recording-chapter');
			if (!buttons.length) {
				return;
			}

			buttons.forEach((button) => {
				button.addEventListener('click', () => {
					const rawTime = button.getAttribute('data-time');
					const time = rawTime ? Number(rawTime) : 0;
					if (playerInstance && Number.isFinite(time)) {
						playerInstance.seek(time);
						if (typeof playerInstance.play === 'function') {
							playerInstance.play();
						}
					}
				});
			});
		}

		function startPlayer() {
			const el = document.getElementById('player');
			if (window.AsciinemaPlayer && el) {
				const cast = el.getAttribute('data-cast') || '/simon_demo.cast';
				playerInstance = AsciinemaPlayer.create(cast, el, {
					autoPlay: true,
					loop: true,
					speed: 1.1,
					theme: 'monokai',
					terminalFontSize: '13px',
					fit: 'width'
				});
				hookChapterControls();
			} else {
				setTimeout(startPlayer, 200);
			}
		}

		startPlayer();
	</script>
</Layout>
