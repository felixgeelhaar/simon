id: analyzed-spec
title: Simon — Product Requirements Document (PRD)
description: ""
features:
    - id: product-goals
      title: Product Goals
      description: |-
        Simon is successful when:

        - tasks complete in fewer conversational turns
        - long-running sessions do not require manual resets
        - tool-heavy workflows remain viable
        - users trust Simon to stop waste proactively

        ---
      requirements: []
    - id: user-problems
      title: User Problems
      description: |-
        1. Users waste turns clarifying vague prompts.
        2. Agents re-plan instead of executing.
        3. Tool outputs consume most of the context window.
        4. Long loops run past the point of usefulness.
        5. Users only realize cost problems after limits are hit.

        ---
      requirements: []
    - id: core-product-capabilities
      title: Core Product Capabilities
      description: |-
        ### 1. Coach (Pre-Execution)

        **User Outcome**
        Fewer clarification turns.

        **Requirements**

        - Structured task specification:
        - Goal
        - Definition of Done
        - Constraints
        - Evidence
        - Deterministic prompt linting
        - Detection of missing signal (e.g. no DoD, no evidence)
        - Estimated usage / burn preview before execution

        **Out of Scope**

        - Generative prompt rewriting
        - Prompt experimentation tooling

        ---

        ### 2. Guard (Always-On Enforcement)

        **User Outcome**
        No catastrophic waste.

        **Requirements**

        - Hard budgets for:
        - prompt size
        - evidence size
        - diffs
        - tool outputs
        - Scope enforcement:
        - allowed files
        - allowed commands
        - Iteration limits
        - Repeat-failure detection
        - Explicit stop conditions

        Violations block execution rather than warn.

        ---

        ### 3. Runtime (Segmented Execution Loop)

        **User Outcome**
        Run longer without context collapse.

        **Requirements**

        - Episodic execution (fresh model call per iteration)
        - Externalized state
        - Rolling session summary
        - Deterministic execution state machine
        - Verification-driven loops (tests, commands)

        ---

        ### 4. Tool Output Control (MCP Firewall)

        **User Outcome**
        Tool tokens become manageable.

        **Requirements**

        - MCP proxy capability
        - Artifact storage for raw tool outputs
        - Digest + extract pattern
        - First-class support for:
        - Playwright
        - Chrome DevTools
        - logs and traces

        ---
      requirements: []
    - id: non-goals
      title: Non-Goals
      description: |-
        Simon will not:

        - act as an IDE
        - replace AI models
        - perform silent refactors
        - run unlimited autonomous agents
        - bypass provider usage limits

        ---
      requirements: []
    - id: constraints
      title: Constraints
      description: |-
        - Must work with existing CLIs
        - Local-first execution
        - Go-based implementation
        - Extensible via plugins
        - Graceful degradation when MCP is unavailable
      requirements: []
    - id: design-goals
      title: Design Goals
      description: |-
        - Deterministic behavior
        - Predictable cost and execution
        - Clear separation of concerns
        - Extensibility without core modification

        ---
      requirements: []
    - id: high-level-architecture
      title: High-Level Architecture
      description: |-
        User
        └── Simon CLI / TUI
        └── Coach
        └── Guard (Policy Engine)
        └── Runtime Engine
        ├── Provider Adapter
        ├── Tool Gateway (MCP Proxy)
        └── Artifact Store

        ---

        Libraris we want to use:

        - felixgeelhaar/statekit # state
        - felixgeelhaar/fortify # Resilience
        - felixgeelhaar/bolt # high-efficient logging
        - felixgeelhaar/mcp-go # Only if needed
      requirements: []
    - id: core-architectural-decisions
      title: Core Architectural Decisions
      description: |-
        ### Deterministic Control Plane

        - No LLMs in Simon’s control logic
        - Enforcement is rule-based
        - AI models are treated as external workers

        ---

        ### Episodic Execution Model

        - Each iteration is stateless from the model’s perspective
        - Session state persists on disk
        - Summaries replace growing transcripts

        This prevents context window exhaustion.

        ---

        ### Policy as Code

        - Budgets and scopes are declarative
        - Policies evaluated before execution
        - Violations halt execution

        ---

        ### Plugin Architecture

        **Mechanism**

        - gRPC-based plugins (HashiCorp go-plugin style)

        **Extension Points**

        - Coach plugins
        - Context selectors
        - Tool output reducers
        - Loop strategies
        - Provider adapters

        Plugins are isolated, versioned, and optional.

        ---
      requirements: []
    - id: grpc-plugins
      title: gRPC Plugin System
      description: |-
        Move from internal interfaces to a true gRPC-based plugin architecture using hashicorp/go-plugin.
        Allows extension of Coach and Guard logic in any language.
    - id: advanced-context
      title: Advanced Context Management
      description: |-
        Implement Vector Memory for retrieving past successful sessions.
        Support Tree-of-Thoughts execution branching.
    - id: ci-cd-integration
      title: CI/CD Integration
      description: |-
        Headless execution mode for CI environments.
        Structured output (SARIF/JUnit).
    - id: interactive-tui
      title: Interactive TUI
      description: |-
        Rich terminal UI using bubbletea.
        Real-time cost tracking, live diffs, and interactive approvals.
    - id: multi-agent
      title: Multi-Agent Orchestration
      description: |-
        Support for Planner/Executor/Reviewer agent topologies governed by Simon.
    - id: marketing-site
      title: Marketing Website
      description: |-
        A visually appealing marketing page to showcase Simon's capabilities.
        
        **Requirements**
        - Framework: Astro + Vue.
        - Design: Inspired by "Simon the Sorcerer" (Classic retro fantasy palette: deep purples, vibrant greens).
        - Content: Hero section with the Asciinema recording, feature grid, and technical architecture.
        - Deployment: Fully automated via GitHub Actions to GitHub Pages.
    - id: tool-gateway-(mcp-proxy)
      title: Tool Gateway (MCP Proxy)
      description: |-
        - JSON-RPC interception
        - Raw tool outputs stored as artifacts
        - Reduced digests returned to runtime
        - Targeted extraction supported on demand

        ---
      requirements: []
    - id: storage-model
      title: Storage Model
      description: |-
        - SQLite:
        - sessions
        - state
        - artifact index
        - Filesystem:
        - raw artifacts
        - Markdown:
        - human-readable summaries

        ---
      requirements: []
    - id: observability
      title: Observability
      description: |-
        - Structured logs
        - OpenTelemetry spans per iteration
        - Deterministic replay supported

        ---
      requirements: []
    - id: security-&-safety-considerations
      title: Security & Safety Considerations
      description: |-
        - File and command scope enforcement
        - Plugin isolation boundaries
        - Explicit stop conditions for loops
      requirements: []
    - id: vision-statement
      title: Vision Statement
      description: |-
        Simon enables developers to get the maximum real work done per AI session by enforcing clarity, discipline, and limits at runtime.

        Simon exists to make powerful AI tools usable longer, cheaper, and more predictably — without constant human babysitting.

        ---
      requirements: []
    - id: the-problem-space
      title: The Problem Space
      description: |-
        Modern AI coding tools are powerful but fragile.

        Developers lose time, money, and momentum because:

        - prompts are underspecified, leading to clarification thrash
        - agents repeatedly re-plan instead of executing
        - tool outputs (Playwright, Chrome DevTools, logs) flood context
        - long-running loops silently burn usage limits
        - there is no feedback before cost is incurred

        Discipline today is:

        - manual
        - implicit
        - inconsistent
        - learned through failure

        ---
      requirements: []
    - id: target-users
      title: Target Users
      description: |-
        ### Primary: Power Developers

        - Use Claude Code, Codex, or Gemini CLI daily
        - Run long debugging, refactors, or E2E workflows
        - Feel usage limits personally
        - Already skilled and disciplined, but constrained

        **Primary Job to Be Done**
        Help me finish real tasks in fewer turns, without restarting sessions or micromanaging the agent.

        ---

        ### Secondary: Platform / Infrastructure Engineers

        - Exploring agents in automation, CI, and remediation
        - Need predictability, budgets, and safety
        - Optimize for reliability over cleverness

        **Primary Job to Be Done**
        Make agent behavior bounded, auditable, and cost-aware.

        ---
      requirements: []
    - id: product-positioning
      title: Product Positioning
      description: |-
        Simon is infrastructure for working with AI agents.

        Simon does not:

        - compete with AI models
        - replace IDEs
        - provide autonomous “magic agents”

        Simon governs how AI power is applied.

        ---
      requirements: []
    - id: strategic-principles
      title: Strategic Principles
      description: |-
        1. **Outcomes over features**
        If it does not reduce wasted turns, tokens, or intervention, it does not ship.

        2. **Guardrails beat advice**
        Warnings are ignored. Enforcement changes behavior.

        3. **Runtime control over prompt cleverness**
        Discipline must be systematic, not heroic.

        4. **Context is a scarce resource**
        Tokens are treated like CPU or memory.

        5. **Humans stay in control**
        No silent autonomy. Every loop has stop conditions.

        ---
      requirements: []
    - id: long-term-vision-(full-horizon)
      title: Long-Term Vision (Full Horizon)
      description: |-
        Over time, Simon evolves from:

        - a local developer runtime

        into:

        - a shared policy and execution layer for AI-assisted work
        - usable in CI, automation, and remediation workflows
        - with consistent enforcement across environments

        Simon becomes an **infra primitive** for safe, cost-aware AI execution.
      requirements: []
constraints: []
version: 0.1.0
