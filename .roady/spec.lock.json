{
  "id": "analyzed-spec",
  "title": "Simon — Product Requirements Document (PRD)",
  "description": "",
  "features": [
    {
      "id": "product-goals",
      "title": "Product Goals",
      "description": "Simon is successful when:\n\n- tasks complete in fewer conversational turns\n- long-running sessions do not require manual resets\n- tool-heavy workflows remain viable\n- users trust Simon to stop waste proactively\n\n---",
      "requirements": []
    },
    {
      "id": "user-problems",
      "title": "User Problems",
      "description": "1. Users waste turns clarifying vague prompts.\n2. Agents re-plan instead of executing.\n3. Tool outputs consume most of the context window.\n4. Long loops run past the point of usefulness.\n5. Users only realize cost problems after limits are hit.\n\n---",
      "requirements": []
    },
    {
      "id": "core-product-capabilities",
      "title": "Core Product Capabilities",
      "description": "### 1. Coach (Pre-Execution)\n\n**User Outcome**\nFewer clarification turns.\n\n**Requirements**\n\n- Structured task specification:\n- Goal\n- Definition of Done\n- Constraints\n- Evidence\n- Deterministic prompt linting\n- Detection of missing signal (e.g. no DoD, no evidence)\n- Estimated usage / burn preview before execution\n\n**Out of Scope**\n\n- Generative prompt rewriting\n- Prompt experimentation tooling\n\n---\n\n### 2. Guard (Always-On Enforcement)\n\n**User Outcome**\nNo catastrophic waste.\n\n**Requirements**\n\n- Hard budgets for:\n- prompt size\n- evidence size\n- diffs\n- tool outputs\n- Scope enforcement:\n- allowed files\n- allowed commands\n- Iteration limits\n- Repeat-failure detection\n- Explicit stop conditions\n\nViolations block execution rather than warn.\n\n---\n\n### 3. Runtime (Segmented Execution Loop)\n\n**User Outcome**\nRun longer without context collapse.\n\n**Requirements**\n\n- Episodic execution (fresh model call per iteration)\n- Externalized state\n- Rolling session summary\n- Deterministic execution state machine\n- Verification-driven loops (tests, commands)\n\n---\n\n### 4. Tool Output Control (MCP Firewall)\n\n**User Outcome**\nTool tokens become manageable.\n\n**Requirements**\n\n- MCP proxy capability\n- Artifact storage for raw tool outputs\n- Digest + extract pattern\n- First-class support for:\n- Playwright\n- Chrome DevTools\n- logs and traces\n\n---",
      "requirements": []
    },
    {
      "id": "non-goals",
      "title": "Non-Goals",
      "description": "Simon will not:\n\n- act as an IDE\n- replace AI models\n- perform silent refactors\n- run unlimited autonomous agents\n- bypass provider usage limits\n\n---",
      "requirements": []
    },
    {
      "id": "constraints",
      "title": "Constraints",
      "description": "- Must work with existing CLIs\n- Local-first execution\n- Go-based implementation\n- Extensible via plugins\n- Graceful degradation when MCP is unavailable",
      "requirements": []
    },
    {
      "id": "design-goals",
      "title": "Design Goals",
      "description": "- Deterministic behavior\n- Predictable cost and execution\n- Clear separation of concerns\n- Extensibility without core modification\n\n---",
      "requirements": []
    },
    {
      "id": "high-level-architecture",
      "title": "High-Level Architecture",
      "description": "User\n└── Simon CLI / TUI\n└── Coach\n└── Guard (Policy Engine)\n└── Runtime Engine\n├── Provider Adapter\n├── Tool Gateway (MCP Proxy)\n└── Artifact Store\n\n---\n\nLibraris we want to use:\n\n- felixgeelhaar/statekit # state\n- felixgeelhaar/fortify # Resilience\n- felixgeelhaar/bolt # high-efficient logging\n- felixgeelhaar/mcp-go # Only if needed",
      "requirements": []
    },
    {
      "id": "core-architectural-decisions",
      "title": "Core Architectural Decisions",
      "description": "### Deterministic Control Plane\n\n- No LLMs in Simon’s control logic\n- Enforcement is rule-based\n- AI models are treated as external workers\n\n---\n\n### Episodic Execution Model\n\n- Each iteration is stateless from the model’s perspective\n- Session state persists on disk\n- Summaries replace growing transcripts\n\nThis prevents context window exhaustion.\n\n---\n\n### Policy as Code\n\n- Budgets and scopes are declarative\n- Policies evaluated before execution\n- Violations halt execution\n\n---\n\n### Plugin Architecture\n\n**Mechanism**\n\n- gRPC-based plugins (HashiCorp go-plugin style)\n\n**Extension Points**\n\n- Coach plugins\n- Context selectors\n- Tool output reducers\n- Loop strategies\n- Provider adapters\n\nPlugins are isolated, versioned, and optional.\n\n---",
      "requirements": []
    },
    {
      "id": "grpc-plugins",
      "title": "gRPC Plugin System",
      "description": "Move from internal interfaces to a true gRPC-based plugin architecture using hashicorp/go-plugin.\nAllows extension of Coach and Guard logic in any language.",
      "requirements": null
    },
    {
      "id": "advanced-context",
      "title": "Advanced Context Management",
      "description": "Implement Vector Memory for retrieving past successful sessions.\nSupport Tree-of-Thoughts execution branching.",
      "requirements": null
    },
    {
      "id": "ci-cd-integration",
      "title": "CI/CD Integration",
      "description": "Headless execution mode for CI environments.\nStructured output (SARIF/JUnit).",
      "requirements": null
    },
    {
      "id": "interactive-tui",
      "title": "Interactive TUI",
      "description": "Rich terminal UI using bubbletea.\nReal-time cost tracking, live diffs, and interactive approvals.",
      "requirements": null
    },
    {
      "id": "multi-agent",
      "title": "Multi-Agent Orchestration",
      "description": "Support for Planner/Executor/Reviewer agent topologies governed by Simon.",
      "requirements": null
    },
    {
      "id": "marketing-site",
      "title": "Marketing Website",
      "description": "A visually appealing marketing page to showcase Simon's capabilities.\n\n**Requirements**\n- Framework: Astro + Vue.\n- Design: Inspired by \"Simon the Sorcerer\" (Classic retro fantasy palette: deep purples, vibrant greens).\n- Content: Hero section with the Asciinema recording, feature grid, and technical architecture.\n- Deployment: Fully automated via GitHub Actions to GitHub Pages.",
      "requirements": null
    },
    {
      "id": "tool-gateway-(mcp-proxy)",
      "title": "Tool Gateway (MCP Proxy)",
      "description": "- JSON-RPC interception\n- Raw tool outputs stored as artifacts\n- Reduced digests returned to runtime\n- Targeted extraction supported on demand\n\n---",
      "requirements": []
    },
    {
      "id": "storage-model",
      "title": "Storage Model",
      "description": "- SQLite:\n- sessions\n- state\n- artifact index\n- Filesystem:\n- raw artifacts\n- Markdown:\n- human-readable summaries\n\n---",
      "requirements": []
    },
    {
      "id": "observability",
      "title": "Observability",
      "description": "- Structured logs\n- OpenTelemetry spans per iteration\n- Deterministic replay supported\n\n---",
      "requirements": []
    },
    {
      "id": "security-\u0026-safety-considerations",
      "title": "Security \u0026 Safety Considerations",
      "description": "- File and command scope enforcement\n- Plugin isolation boundaries\n- Explicit stop conditions for loops",
      "requirements": []
    },
    {
      "id": "vision-statement",
      "title": "Vision Statement",
      "description": "Simon enables developers to get the maximum real work done per AI session by enforcing clarity, discipline, and limits at runtime.\n\nSimon exists to make powerful AI tools usable longer, cheaper, and more predictably — without constant human babysitting.\n\n---",
      "requirements": []
    },
    {
      "id": "the-problem-space",
      "title": "The Problem Space",
      "description": "Modern AI coding tools are powerful but fragile.\n\nDevelopers lose time, money, and momentum because:\n\n- prompts are underspecified, leading to clarification thrash\n- agents repeatedly re-plan instead of executing\n- tool outputs (Playwright, Chrome DevTools, logs) flood context\n- long-running loops silently burn usage limits\n- there is no feedback before cost is incurred\n\nDiscipline today is:\n\n- manual\n- implicit\n- inconsistent\n- learned through failure\n\n---",
      "requirements": []
    },
    {
      "id": "target-users",
      "title": "Target Users",
      "description": "### Primary: Power Developers\n\n- Use Claude Code, Codex, or Gemini CLI daily\n- Run long debugging, refactors, or E2E workflows\n- Feel usage limits personally\n- Already skilled and disciplined, but constrained\n\n**Primary Job to Be Done**\nHelp me finish real tasks in fewer turns, without restarting sessions or micromanaging the agent.\n\n---\n\n### Secondary: Platform / Infrastructure Engineers\n\n- Exploring agents in automation, CI, and remediation\n- Need predictability, budgets, and safety\n- Optimize for reliability over cleverness\n\n**Primary Job to Be Done**\nMake agent behavior bounded, auditable, and cost-aware.\n\n---",
      "requirements": []
    },
    {
      "id": "product-positioning",
      "title": "Product Positioning",
      "description": "Simon is infrastructure for working with AI agents.\n\nSimon does not:\n\n- compete with AI models\n- replace IDEs\n- provide autonomous “magic agents”\n\nSimon governs how AI power is applied.\n\n---",
      "requirements": []
    },
    {
      "id": "strategic-principles",
      "title": "Strategic Principles",
      "description": "1. **Outcomes over features**\nIf it does not reduce wasted turns, tokens, or intervention, it does not ship.\n\n2. **Guardrails beat advice**\nWarnings are ignored. Enforcement changes behavior.\n\n3. **Runtime control over prompt cleverness**\nDiscipline must be systematic, not heroic.\n\n4. **Context is a scarce resource**\nTokens are treated like CPU or memory.\n\n5. **Humans stay in control**\nNo silent autonomy. Every loop has stop conditions.\n\n---",
      "requirements": []
    },
    {
      "id": "long-term-vision-(full-horizon)",
      "title": "Long-Term Vision (Full Horizon)",
      "description": "Over time, Simon evolves from:\n\n- a local developer runtime\n\ninto:\n\n- a shared policy and execution layer for AI-assisted work\n- usable in CI, automation, and remediation workflows\n- with consistent enforcement across environments\n\nSimon becomes an **infra primitive** for safe, cost-aware AI execution.",
      "requirements": []
    }
  ],
  "constraints": [],
  "version": "0.1.0"
}